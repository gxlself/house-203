(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-index"],{"02e1":function(t,e,n){var a=n("84e3");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=n("4f06").default;o("3e7529ea",a,!0,{sourceMap:!1,shadowMode:!1})},"085f":function(t,e,n){"use strict";var a,o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"header-bar gxl-b gxl-white"},[n("v-uni-text",{staticClass:"header-left",class:{back:t.back},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.navigateBack.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"title"},[t._v(t._s(t.title))]),n("v-uni-text",{staticClass:"header-right",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.rightEvent.apply(void 0,arguments)}}},[t._v(t._s(t.sure))])],1)},i=[];n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}))},1707:function(t,e,n){"use strict";n.r(e);var a=n("a04c"),o=n("53ed");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("1ae3");var r,c=n("f0c5"),s=Object(c["a"])(o["default"],a["b"],a["c"],!1,null,"6b56e588",null,!1,a["a"],r);e["default"]=s.exports},"1ae3":function(t,e,n){"use strict";var a=n("02e1"),o=n.n(a);o.a},"1de5":function(t,e,n){"use strict";t.exports=function(t,e){return e||(e={}),t=t&&t.__esModule?t.default:t,"string"!==typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},3181:function(t,e,n){"use strict";n.r(e);var a=n("a3d1"),o=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},"494c":function(t,e,n){"use strict";n.r(e);var a=n("085f"),o=n("3181");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("5a30");var r,c=n("f0c5"),s=Object(c["a"])(o["default"],a["b"],a["c"],!1,null,"3f6c6a64",null,!1,a["a"],r);e["default"]=s.exports},"53ed":function(t,e,n){"use strict";n.r(e);var a=n("b54f"),o=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},"5a30":function(t,e,n){"use strict";var a=n("7ce9"),o=n.n(a);o.a},"7ce9":function(t,e,n){var a=n("b378");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=n("4f06").default;o("971e3928",a,!0,{sourceMap:!1,shadowMode:!1})},"832b":function(t,e,n){t.exports=n.p+"static/img/header-back.fd79572b.png"},"84e3":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.chat-page[data-v-6b56e588]{position:fixed;top:0;left:0;right:0;bottom:0;-webkit-transition:.3s;transition:.3s}.chat-page .bottom-input[data-v-6b56e588]{position:fixed;bottom:0;left:0;right:0;padding:%?10?% %?30?%;background:#f8f8f8;border-top:%?1?% solid #ebebeb;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;z-index:3}.chat-page .bottom-input uni-input[data-v-6b56e588]{background:#fff;padding:%?4?% %?15?%;-webkit-box-flex:1;-webkit-flex:1;flex:1}.chat-page .bottom-input .send-chat[data-v-6b56e588]{margin-left:%?15?%;height:%?60?%;line-height:%?58?%;text-align:center;font-size:%?24?%;border-radius:%?8?%}.chat-page .scroll-view[data-v-6b56e588]{height:100vh;box-sizing:border-box;padding:%?80?% %?0?%}.chat-page .scroll-view.iphoneX-content-padding[data-v-6b56e588]{padding-bottom:%?140?%}.chat-page .iphoneX[data-v-6b56e588]{padding-bottom:%?68?%}.user-chat[data-v-6b56e588]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;padding:0 %?20?%}.user-chat .left-ava[data-v-6b56e588], .user-chat .right-ava[data-v-6b56e588], .user-chat .left-node[data-v-6b56e588], .user-chat .right-node[data-v-6b56e588]{width:%?70?%;height:%?70?%;line-height:%?70?%;text-align:center;border-radius:50%}.user-chat .left-ava[data-v-6b56e588], .user-chat .right-ava[data-v-6b56e588]{background:#eee}.user-chat .left-node[data-v-6b56e588], .user-chat .right-node[data-v-6b56e588]{background:none}.user-chat[data-v-6b56e588]{margin:%?24?% 0}.user-chat[data-v-6b56e588]:last-child{margin-bottom:%?24?%}.chat-content[data-v-6b56e588]{-webkit-box-flex:1;-webkit-flex:1;flex:1;margin:0 %?16?%}.chat-content uni-text[data-v-6b56e588]{font-size:%?28?%;display:-webkit-inline-box;display:-webkit-inline-flex;display:inline-flex;background:#fff;padding:%?16?% %?20?%;text-align:justify;border-radius:%?8?%;word-break:break-all;-webkit-transform:translateY(%?-12?%);transform:translateY(%?-12?%)}.chat-content .chat-nick[data-v-6b56e588]{color:#888;font-size:%?24?%;padding:%?5?% 0;-webkit-transform:translateY(%?-12?%);transform:translateY(%?-12?%)}.chat-content .other[data-v-6b56e588], .chat-content .userself[data-v-6b56e588]{position:relative}.chat-content .userself[data-v-6b56e588]{background:#0f0}.chat-content .other[data-v-6b56e588]::before, .chat-content .other[data-v-6b56e588]::after, .chat-content .userself[data-v-6b56e588]::before, .chat-content .userself[data-v-6b56e588]::after{position:absolute;content:"";width:%?16?%;height:%?16?%}.chat-content .other[data-v-6b56e588]::before{background:#fff;left:%?-16?%;z-index:1}.chat-content .other[data-v-6b56e588]::after{left:%?-16?%;border-radius:0 100% 0 0;background:#f8f8f8;z-index:2}.chat-content .userself[data-v-6b56e588]::before{background:#0f0;right:%?-16?%;z-index:1}.chat-content .userself[data-v-6b56e588]::after{background:#fff;right:%?-16?%;border-radius:100% 0 0 0;background:#f8f8f8;z-index:2}.chat-left .chat-content[data-v-6b56e588]{text-align:left}.chat-right .chat-content[data-v-6b56e588]{text-align:right}',""]),t.exports=e},"9a44":function(t,e,n){"use strict";var a=n("eca2"),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return uni.showLoading(),new Promise((function(o,i){var r=uni.getStorageSync("token"),c=uni.getStorageSync("username");if(!r||!c)return uni.clearStorageSync(),uni.reLaunch({url:"../../pages/login/login"}),void i(new Error("token失效"));uni.request({url:a.API_URL+t,data:e,method:n,header:{authorization:"".concat(r,",").concat(c)},success:function(t){console.log(200===t.data.status),401===t.statusCode?(uni.clearStorageSync(),uni.reLaunch({url:"../../pages/login/login"}),i(new Error("token失效"))):200===t.statusCode&&o(t.data),uni.hideLoading()},fail:function(t){i(t),uni.hideLoading()}})}))},i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return uni.showLoading(),new Promise((function(o,i){uni.request({url:a.API_URL+t,data:e,method:n,success:function(t){o(t.data),uni.hideLoading()},fail:function(t){i(t),uni.hideLoading()}})}))},r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return new Promise((function(o,i){uni.request({url:a.API_URL+t,data:e,method:n,success:function(t){o(t.data),uni.hideLoading()},fail:function(t){i(t)}})}))},c=function t(e){var n=uni.getStorageSync("token"),o=uni.getStorageSync("username");return n&&o?new Promise((function(i,r){var c=uni.connectSocket({url:a.WS_URL+e+"?authorization=".concat(n,",").concat(o),complete:function(){}});c.onOpen((function(){var t={type:"refreshConnect",content:"重新连入"};c.send({data:JSON.stringify(t),success:function(){console.log("send success")}}),i(c)})),c.onError((function(){t(e).then((function(){}))}))})):(uni.clearStorageSync(),void uni.reLaunch({url:"../../pages/login/login"}))};t.exports={request:o,login:i,register:r,socketTask:c}},a04c:function(t,e,n){"use strict";var a,o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"chat-page gxl-white"},[n("header-bar",{attrs:{title:"203屋",back:!1,sure:"退出"},on:{surefun:function(e){arguments[0]=e=t.$handleEvent(e),t.loginout.apply(void 0,arguments)}}}),n("v-uni-scroll-view",{staticClass:"scroll-view",class:{"iphoneX-content-padding":t.isIphoneX},staticStyle:{background:"#F8F8F8"},attrs:{"scroll-y":!0,"scroll-with-animation":"true","scroll-top":t.scrollTop,id:"scrollView"},on:{scrolltoupper:function(e){arguments[0]=e=t.$handleEvent(e),t.scrolltoupper.apply(void 0,arguments)},scrolltolower:function(e){arguments[0]=e=t.$handleEvent(e),t.scrolltolower.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"chat-list"},t._l(t.chats,(function(e,a){return n("v-uni-view",{key:a,staticClass:"user-chat",class:[{"chat-left":t.username!==e.from},{"chat-right":t.username===e.from}]},[n("v-uni-view",{class:[{"left-ava":t.username!==e.from},{"left-node":t.username===e.from}]},[t._v(t._s(t.username!==e.from?e.from[0]:""))]),n("v-uni-view",{staticClass:"chat-content"},[n("v-uni-view",{staticClass:"chat-nick"},[t._v(t._s(e.from))]),n("v-uni-text",{class:[{userself:!(t.username!==e.from)},{other:t.username!==e.from}],domProps:{innerHTML:t._s(e.content.default)}})],1),n("v-uni-view",{class:[{"right-ava":t.username===e.from},{"right-node":t.username!==e.from}]},[t._v(t._s(t.username===e.from?e.from[0]:""))])],1)})),1)],1),n("v-uni-view",{staticClass:"bottom-input",class:{iphoneX:t.isIphoneX}},[n("v-uni-input",{staticClass:"chat-input",attrs:{type:"text",focus:!0,"confirm-type":"send","confirm-hold":!0},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.blur.apply(void 0,arguments)},focus:function(e){arguments[0]=e=t.$handleEvent(e),t.focus.apply(void 0,arguments)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.sendMessage.apply(void 0,arguments)}},model:{value:t.chatContent,callback:function(e){t.chatContent=e},expression:"chatContent"}}),!t.isFocus&&t.chatContent?n("v-uni-button",{staticClass:"send-chat",attrs:{type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.sendMessage.apply(void 0,arguments)}}},[t._v("+")]):t._e(),!t.isFocus&&t.chatContent?n("v-uni-button",{staticClass:"send-chat",attrs:{type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.sendMessage.apply(void 0,arguments)}}},[t._v("发送")]):t._e()],1)],1)},i=[];n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}))},a3d1:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{}},props:{back:{type:Boolean,default:!0},sure:{type:String,default:""},title:{type:String,default:"203"}},methods:{rightEvent:function(t){this.$emit("surefun",t)},navigateBack:function(){uni.navigateBack()}}};e.default=a},b378:function(t,e,n){var a=n("24fb"),o=n("1de5"),i=n("832b");e=a(!1);var r=o(i);e.push([t.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.header-bar[data-v-3f6c6a64]{position:fixed;top:0;left:0;right:0;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center;font-size:%?30?%;text-align:right;z-index:2}.header-bar .header-left[data-v-3f6c6a64], .header-bar .header-right[data-v-3f6c6a64]{width:%?150?%;height:%?80?%;line-height:%?80?%}.header-bar .back[data-v-3f6c6a64]{background:url('+r+") %?10?% 50% no-repeat;background-size:%?30?%}.header-bar .header-left[data-v-3f6c6a64]{padding-left:%?20?%}.header-bar .header-right[data-v-3f6c6a64]{color:#fc8800;padding-right:%?20?%}.header-bar .title[data-v-3f6c6a64]{color:#2a2a2a}",""]),t.exports=e},b54f:function(t,e,n){"use strict";var a=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n("9a44"),i=a(n("494c")),r=null,c={data:function(){return{usernameFoucus:!1,passwordFoucus:!1,chatContent:"",chats:[],users:{},scrollTop:1e3,isFocus:!1,groupId:1,size:15,page:1,count:0,chatType:"groupChat",isLoading:!1}},components:{headerBar:i.default},onLoad:function(){this.getCacheChat(),this.initConnect((function(t){var e={type:"getUserInfo",groupId:1};t.send({data:JSON.stringify(e)})}))},methods:{onMessage:function(t){var e=this,n=this,a=JSON.parse(t.data);if(-1===a.code){uni.clearStorageSync(),uni.showToast({title:"登录状态失效",icon:"loading",mask:!0});var o=setTimeout((function(){clearTimeout(o),uni.reLaunch({url:"../login/login"})}),1e3)}else switch(a.data.type){case"groupChat":n.chats.push(a.data),n.$nextTick((function(){e.scrollToBottom()}));break;case"getUserInfo":console.log(a.data);uni.setStorageSync("group-".concat(this.groupId),a.data);break}},onError:function(t){this.initConnect()},closeSocket:function(){this.initConnect()},focus:function(){var t=setTimeout((function(){document.body.scrollTo(0,9999),clearTimeout(t)}),200);this.isFocus=!0},blur:function(){document.scrollingElement.scrollTo(0,0),this.isFocus=!1},loginout:function(){uni.clearStorageSync(),uni.showToast({title:"登出成功",icon:"loading",mask:!0});var t=setTimeout((function(){clearTimeout(t),uni.reLaunch({url:"../login/login"})}),1e3)},sendMessage:function(){var t=this;if(uni.hideKeyboard(),""!==t.chatContent){var e={type:this.chatType,groupId:t.groupId,user:t.username,content:{type:"text",default:t.chatContent}};r?r.send({data:JSON.stringify(e),success:function(){t.chatContent=""}}):t.initConnect((function(n){n.send({data:JSON.stringify(e),success:function(){t.chatContent=""}})}))}},scrolltoupper:function(){this.isLoading||this.chats.length>=this.count||(this.isLoading=!0,this.getCacheChat())},scrolltolower:function(){},initConnect:function(t){var e=this;r=null,(0,o.socketTask)("/user").then((function(t){return r=t,r.onMessage(e.onMessage),r.onError(e.onError),r.onClose(e.closeSocket),t})).then((function(e){"function"===typeof t&&t(e)}))},scrollToBottom:function(){this.getNode().then((function(t){console.log(t)})),this.scrollTop+=300},getNode:function(){return new Promise((function(t,e){var n=uni.createSelectorQuery().in(this);n.select("#scrollView").boundingClientRect((function(n){try{t(n)}catch(a){e(a)}})).exec()}))},getCacheChat:function(){var t=this,e={size:this.size,page:this.page,groupId:this.groupId,chatType:this.chatType};(0,o.request)("/user/chatlist",e,"POST").then((function(e){return 0===e.code?t.chats=e.data.chats.concat(t.chats):uni.showToast({icon:"none",title:e.msg}),e})).catch((function(t){uni.showToast({icon:"none",title:t.message})})).then((function(e){t.count=e.data.count;var n=Math.ceil(t.count/t.size);t.isLoading&&t.page<n?(t.isLoading=!1,t.page++):t.scrollToBottom()}))}},onHide:function(){this.initConnect()},onUnload:function(){r=null},computed:{isIphoneX:function(){var t=uni.getSystemInfoSync();return"ios"===t.platform&&t.screenHeight>=812},username:function(){return uni.getStorageSync("username")}}};e.default=c},eca2:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.API_URL=e.WS_URL=void 0;var a="https://gxlchat.utools.club";e.API_URL=a;var o="wss://gxlchat.utools.club";e.WS_URL=o}}]);